"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
/* tslint:disable no-console */
const ng_html_parser_1 = require("../utils/ng-html-parser");
const fs = tslib_1.__importStar(require("fs"));
const _ = tslib_1.__importStar(require("lodash"));
describe('ng-html-parser', () => {
    let lexer;
    beforeEach(() => {
        lexer = new ng_html_parser_1.TemplateLexer('abcde');
    });
    xit('Lexer.la()  should work', () => {
        // let lexer = new ps.Lexer('abcde');
        expect(lexer.la()).toEqual('a');
        expect(lexer.la(2)).toEqual('b');
        expect(lexer.la(3)).toEqual('c');
    });
    xit('Lexer.advance()  should work', () => {
        lexer.advance(2);
        expect(lexer.la()).toEqual('c');
        expect(lexer.la(3)).toEqual('e');
        expect(lexer.la(7)).toEqual(null);
    });
    xit('Lexer.isNext("cde") should work', () => {
        lexer = new ng_html_parser_1.TemplateLexer('cde');
        expect(lexer.isNext('cde')).toBeTruthy();
        expect(lexer.isNext('cd')).toBeTruthy();
        expect(lexer.isNext('cdef')).toBeFalsy();
    });
    const lexer2 = new ng_html_parser_1.TemplateLexer('0123\n5678\n0abcd\n');
    xit('line and column shoud be correct', () => {
        expect(lexer2.la(10 + 1)).toEqual('0');
        let chr = lexer2.la();
        while (chr != null) {
            lexer2.advance();
            console.log(lexer2.getCurrentPosInfo());
            chr = lexer2.la();
        }
        console.log(lexer2.lineBeginPositions);
        expect(lexer2.getLineColumn(0)).toEqual([0, 0]);
        expect(lexer2.getLineColumn(3)).toEqual([0, 3]);
        expect(lexer2.getLineColumn(11)).toEqual([2, 1]);
    });
    xit('template lexer should work for test html file', () => {
        const ngHtml = fs.readFileSync(__dirname + '/../../ts/spec/test-parser.html', 'utf8');
        const lexer = new ng_html_parser_1.TemplateLexer(ngHtml);
        for (const token of lexer) {
            console.log(`type: ${ng_html_parser_1.TokenType[token.type]},\ttext: ` + token.text);
        }
    });
    it('parser should work for test html file', () => {
        const ngHtml = fs.readFileSync(__dirname + '/../../ts/spec/test-parser.html', 'utf8');
        const ast = new ng_html_parser_1.TemplateParser(ngHtml).parse();
        console.log(JSON.stringify(ast, null, '  '));
        for (const tag of ast) {
            console.log(tag);
            for (const attrValue of _.values(tag.attrs)) {
                if (attrValue.value == null)
                    continue;
                expect(ngHtml.substring(attrValue.value.start, attrValue.value.end)).toEqual(attrValue.value.text);
            }
        }
        expect(ast[0].start).toBe(0);
    });
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9AZHItY29yZS9uZy1hcHAtYnVpbGRlci90cy9zcGVjL25nLWh0bWwtcGFyc2VyU3BlYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSwrQkFBK0I7QUFDL0IsNERBQWlGO0FBQ2pGLCtDQUF5QjtBQUN6QixrREFBNEI7QUFFNUIsUUFBUSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRTtJQUM5QixJQUFJLEtBQW9CLENBQUM7SUFDekIsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNkLEtBQUssR0FBRyxJQUFJLDhCQUFhLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDckMsQ0FBQyxDQUFDLENBQUM7SUFFSCxHQUFHLENBQUMseUJBQXlCLEVBQUUsR0FBRyxFQUFFO1FBQ2xDLHFDQUFxQztRQUNyQyxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ2hDLE1BQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ2pDLE1BQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ25DLENBQUMsQ0FBQyxDQUFDO0lBRUgsR0FBRyxDQUFDLDhCQUE4QixFQUFFLEdBQUcsRUFBRTtRQUN2QyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2pCLE1BQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDaEMsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDakMsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxD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Q0FBQyxHQUFHLENBQUMsQ0FBQztZQUNqQixLQUFLLE1BQU0sU0FBUyxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxFQUFFO2dCQUMzQyxJQUFJLFNBQVMsQ0FBQyxLQUFLLElBQUksSUFBSTtvQkFDekIsU0FBUztnQkFDWCxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLEtBQUssRUFBRSxTQUFTLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7YUFDcEc7U0FDRjtRQUNELE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQy9CLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJmaWxlIjoibm9kZV9tb2R1bGVzL0Bkci1jb3JlL25nLWFwcC1idWlsZGVyL2Rpc3Qvc3BlYy9uZy1odG1sLXBhcnNlclNwZWMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiB0c2xpbnQ6ZGlzYWJsZSBuby1jb25zb2xlICovXG5pbXBvcnQge1RlbXBsYXRlTGV4ZXIsIFRva2VuVHlwZSwgVGVtcGxhdGVQYXJzZXJ9IGZyb20gJy4uL3V0aWxzL25nLWh0bWwtcGFyc2VyJztcbmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnbG9kYXNoJztcblxuZGVzY3JpYmUoJ25nLWh0bWwtcGFyc2VyJywgKCkgPT4ge1xuICBsZXQgbGV4ZXI6IFRlbXBsYXRlTGV4ZXI7XG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGxleGVyID0gbmV3IFRlbXBsYXRlTGV4ZXIoJ2FiY2RlJyk7XG4gIH0pO1xuXG4gIHhpdCgnTGV4ZXIubGEoKSAgc2hvdWxkIHdvcmsnLCAoKSA9PiB7XG4gICAgLy8gbGV0IGxleGVyID0gbmV3IHBzLkxleGVyKCdhYmNkZScpO1xuICAgIGV4cGVjdChsZXhlci5sYSgpKS50b0VxdWFsKCdhJyk7XG4gICAgZXhwZWN0KGxleGVyLmxhKDIpKS50b0VxdWFsKCdiJyk7XG4gICAgZXhwZWN0KGxleGVyLmxhKDMpKS50b0VxdWFsKCdjJyk7XG4gIH0pO1xuXG4gIHhpdCgnTGV4ZXIuYWR2YW5jZSgpICBzaG91bGQgd29yaycsICgpID0+IHtcbiAgICBsZXhlci5hZHZhbmNlKDIpO1xuICAgIGV4cGVjdChsZXhlci5sYSgpKS50b0VxdWFsKCdjJyk7XG4gICAgZXhwZWN0KGxleGVyLmxhKDMpKS50b0VxdWFsKCdlJyk7XG4gICAgZXhwZWN0KGxleGVyLmxhKDcpKS50b0VxdWFsKG51bGwpO1xuICB9KTtcblxuICB4aXQoJ0xleGVyLmlzTmV4dChcImNkZVwiKSBzaG91bGQgd29yaycsICgpID0+IHtcbiAgICBsZXhlciA9IG5ldyBUZW1wbGF0ZUxleGVyKCdjZGUnKTtcbiAgICBleHBlY3QobGV4ZXIuaXNOZXh0KCdjZGUnKSkudG9CZVRydXRoeSgpO1xuICAgIGV4cGVjdChsZXhlci5pc05leHQoJ2NkJykpLnRvQmVUcnV0aHkoKTtcbiAgICBleHBlY3QobGV4ZXIuaXNOZXh0KCdjZGVmJykpLnRvQmVGYWxzeSgpO1xuICB9KTtcblxuICBjb25zdCBsZXhlcjIgPSBuZXcgVGVtcGxhdGVMZXhlcignMDEyM1xcbjU2NzhcXG4wYWJjZFxcbicpO1xuICB4aXQoJ2xpbmUgYW5kIGNvbHVtbiBzaG91ZCBiZSBjb3JyZWN0JywgKCkgPT4ge1xuICAgIGV4cGVjdChsZXhlcjIubGEoMTAgKyAxKSkudG9FcXVhbCgnMCcpO1xuICAgIGxldCBjaHIgPSBsZXhlcjIubGEoKTtcbiAgICB3aGlsZSAoY2hyICE9IG51bGwpIHtcbiAgICAgIGxleGVyMi5hZHZhbmNlKCk7XG4gICAgICBjb25zb2xlLmxvZyhsZXhlcjIuZ2V0Q3VycmVudFBvc0luZm8oKSk7XG4gICAgICBjaHIgPSBsZXhlcjIubGEoKTtcbiAgICB9XG4gICAgY29uc29sZS5sb2cobGV4ZXIyLmxpbmVCZWdpblBvc2l0aW9ucyk7XG4gICAgZXhwZWN0KGxleGVyMi5nZXRMaW5lQ29sdW1uKDApKS50b0VxdWFsKFswLCAwXSk7XG4gICAgZXhwZWN0KGxleGVyMi5nZXRMaW5lQ29sdW1uKDMpKS50b0VxdWFsKFswLCAzXSk7XG4gICAgZXhwZWN0KGxleGVyMi5nZXRMaW5lQ29sdW1uKDExKSkudG9FcXVhbChbMiwgMV0pO1xuICB9KTtcblxuICB4aXQoJ3RlbXBsYXRlIGxleGVyIHNob3VsZCB3b3JrIGZvciB0ZXN0IGh0bWwgZmlsZScsICgpID0+IHtcbiAgICBjb25zdCBuZ0h0bWwgPSBmcy5yZWFkRmlsZVN5bmMoX19kaXJuYW1lICsgJy8uLi8uLi90cy9zcGVjL3Rlc3QtcGFyc2VyLmh0bWwnLCAndXRmOCcpO1xuICAgIGNvbnN0IGxleGVyID0gbmV3IFRlbXBsYXRlTGV4ZXIobmdIdG1sKTtcbiAgICBmb3IgKGNvbnN0IHRva2VuIG9mIGxleGVyKSB7XG4gICAgICBjb25zb2xlLmxvZyhgdHlwZTogJHtUb2tlblR5cGVbdG9rZW4udHlwZV19LFxcdHRleHQ6IGAgKyB0b2tlbi50ZXh0KTtcbiAgICB9XG4gIH0pO1xuXG4gIGl0KCdwYXJzZXIgc2hvdWxkIHdvcmsgZm9yIHRlc3QgaHRtbCBmaWxlJywgKCkgPT4ge1xuICAgIGNvbnN0IG5nSHRtbCA9IGZzLnJlYWRGaWxlU3luYyhfX2Rpcm5hbWUgKyAnLy4uLy4uL3RzL3NwZWMvdGVzdC1wYXJzZXIuaHRtbCcsICd1dGY4Jyk7XG4gICAgY29uc3QgYXN0ID0gbmV3IFRlbXBsYXRlUGFyc2VyKG5nSHRtbCkucGFyc2UoKTtcbiAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShhc3QsIG51bGwsICcgICcpKTtcbiAgICBmb3IgKGNvbnN0IHRhZyBvZiBhc3QpIHtcbiAgICAgIGNvbnNvbGUubG9nKHRhZyk7XG4gICAgICBmb3IgKGNvbnN0IGF0dHJWYWx1ZSBvZiBfLnZhbHVlcyh0YWcuYXR0cnMpKSB7XG4gICAgICAgIGlmIChhdHRyVmFsdWUudmFsdWUgPT0gbnVsbClcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgZXhwZWN0KG5nSHRtbC5zdWJzdHJpbmcoYXR0clZhbHVlLnZhbHVlLnN0YXJ0LCBhdHRyVmFsdWUudmFsdWUuZW5kKSkudG9FcXVhbChhdHRyVmFsdWUudmFsdWUudGV4dCk7XG4gICAgICB9XG4gICAgfVxuICAgIGV4cGVjdChhc3RbMF0uc3RhcnQpLnRvQmUoMCk7XG4gIH0pO1xufSk7XG4iXX0=
