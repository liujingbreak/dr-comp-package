"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const ts_dep_1 = tslib_1.__importDefault(require("../ts-dep"));
const ts_compiler_1 = require("dr-comp-package/wfh/dist/ts-compiler");
const __api_1 = tslib_1.__importDefault(require("__api"));
const typescript_1 = require("typescript");
const path_1 = tslib_1.__importDefault(require("path"));
function addSourceFiles(compilerOptions, entryFiles, tsconfigFile, fileReplacements) {
    const projDir = path_1.default.dirname(tsconfigFile);
    const g = new ts_dep_1.default(ts_compiler_1.jsonToCompilerOptions(compilerOptions), fileReplacements, file => {
        const content = typescript_1.sys.readFile(file, 'utf8');
        return __api_1.default.browserInjector.injectToFile(file, content || '');
    });
    for (const entryFile of entryFiles) {
        g.walkForDependencies(path_1.default.resolve(projDir, entryFile));
    }
    return Array.from(g.walked.values())
        .map(file => path_1.default.relative(projDir, file).replace(/\\/g, '/'));
}
exports.addSourceFiles = addSourceFiles;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9AZHItY29yZS9uZy1hcHAtYnVpbGRlci90cy9uZy9hZGQtdHNjb25maWctZmlsZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSwrREFBOEI7QUFDOUIsc0VBQTJFO0FBQzNFLDBEQUF3QjtBQUN4QiwyQ0FBaUM7QUFFakMsd0RBQXdCO0FBR3hCLFNBQWdCLGNBQWMsQ0FBQyxlQUFvQixFQUFFLFVBQW9CLEVBQUUsWUFBb0IsRUFDN0YsZ0JBQTJEO0lBRTNELE1BQU0sT0FBTyxHQUFHLGNBQUksQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLENBQUM7SUFDM0MsTUFBTSxDQUFDLEdBQUcsSUFBSSxnQkFBSyxDQUFDLG1DQUFxQixDQUFDLGVBQWUsQ0FBQyxFQUFFLGdCQUFnQixFQUMxRSxJQUFJLENBQUMsRUFBRTtRQUNMLE1BQU0sT0FBTyxHQUFHLGdCQUFHLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsQ0FBQztRQUMzQyxPQUFPLGVBQUcsQ0FBQyxlQUFlLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRSxPQUFPLElBQUksRUFBRSxDQUFDLENBQUM7SUFDL0QsQ0FBQyxDQUFDLENBQUM7SUFDTCxLQUFLLE1BQU0sU0FBUyxJQUFJLFVBQVUsRUFBRTtRQUNsQyxDQUFDLENBQUMsbUJBQW1CLENBQUMsY0FBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDLENBQUMsQ0FBQztLQUN6RDtJQUVELE9BQU8sS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRSxDQUFDO1NBQ2pDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLGNBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQztBQUNuRSxDQUFDO0FBZkQsd0NBZUMiLCJmaWxlIjoibm9kZV9tb2R1bGVzL0Bkci1jb3JlL25nLWFwcC1idWlsZGVyL2Rpc3QvbmcvYWRkLXRzY29uZmlnLWZpbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgR3JhcGggZnJvbSAnLi4vdHMtZGVwJztcbmltcG9ydCB7anNvblRvQ29tcGlsZXJPcHRpb25zfSBmcm9tICdkci1jb21wLXBhY2thZ2Uvd2ZoL2Rpc3QvdHMtY29tcGlsZXInO1xuaW1wb3J0IGFwaSBmcm9tICdfX2FwaSc7XG5pbXBvcnQgeyBzeXMgfSBmcm9tICd0eXBlc2NyaXB0JztcbmltcG9ydCB7IEFuZ3VsYXJCdWlsZGVyT3B0aW9ucyB9IGZyb20gJy4vY29tbW9uJztcbmltcG9ydCBQYXRoIGZyb20gJ3BhdGgnO1xuXG5cbmV4cG9ydCBmdW5jdGlvbiBhZGRTb3VyY2VGaWxlcyhjb21waWxlck9wdGlvbnM6IGFueSwgZW50cnlGaWxlczogc3RyaW5nW10sIHRzY29uZmlnRmlsZTogc3RyaW5nLFxuICBmaWxlUmVwbGFjZW1lbnRzOiBBbmd1bGFyQnVpbGRlck9wdGlvbnNbJ2ZpbGVSZXBsYWNlbWVudHMnXSkge1xuXG4gIGNvbnN0IHByb2pEaXIgPSBQYXRoLmRpcm5hbWUodHNjb25maWdGaWxlKTtcbiAgY29uc3QgZyA9IG5ldyBHcmFwaChqc29uVG9Db21waWxlck9wdGlvbnMoY29tcGlsZXJPcHRpb25zKSwgZmlsZVJlcGxhY2VtZW50cyxcbiAgICBmaWxlID0+IHtcbiAgICAgIGNvbnN0IGNvbnRlbnQgPSBzeXMucmVhZEZpbGUoZmlsZSwgJ3V0ZjgnKTtcbiAgICAgIHJldHVybiBhcGkuYnJvd3NlckluamVjdG9yLmluamVjdFRvRmlsZShmaWxlLCBjb250ZW50IHx8ICcnKTtcbiAgICB9KTtcbiAgZm9yIChjb25zdCBlbnRyeUZpbGUgb2YgZW50cnlGaWxlcykge1xuICAgIGcud2Fsa0ZvckRlcGVuZGVuY2llcyhQYXRoLnJlc29sdmUocHJvakRpciwgZW50cnlGaWxlKSk7XG4gIH1cblxuICByZXR1cm4gQXJyYXkuZnJvbShnLndhbGtlZC52YWx1ZXMoKSlcbiAgICAubWFwKGZpbGUgPT4gUGF0aC5yZWxhdGl2ZShwcm9qRGlyLCBmaWxlKS5yZXBsYWNlKC9cXFxcL2csICcvJykpO1xufVxuIl19
