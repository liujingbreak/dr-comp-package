"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const worker_threads_1 = require("worker_threads");
const common_1 = require("./common");
const injector_setup_1 = require("./injector-setup");
const mem_stats_1 = tslib_1.__importDefault(require("dr-comp-package/wfh/dist/utils/mem-stats"));
const { tsconfigFile, reportDir, config, ngOptions, packageInfo, deployUrl, baseHref, drcpBuilderOptions } = worker_threads_1.workerData;
// tslint:disable: no-console
// console.log(workerData);
mem_stats_1.default();
common_1.initCli(drcpBuilderOptions)
    .then((drcpConfig) => {
    return injector_setup_1.injectorSetup(packageInfo, drcpBuilderOptions.drcpArgs, deployUrl, baseHref);
}).then(() => {
    const create = require('./change-tsconfig').createTsConfig;
    const content = create(tsconfigFile, ngOptions, config, packageInfo, reportDir);
    worker_threads_1.parentPort.postMessage({ log: mem_stats_1.default() });
    worker_threads_1.parentPort.postMessage({ result: content });
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9AZHItY29yZS9uZy1hcHAtYnVpbGRlci90cy9uZy9jaGFuZ2UtdHNjb25maWctd29ya2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLG1EQUFzRDtBQUV0RCxxQ0FBcUQ7QUFDckQscURBQStDO0FBRy9DLGlHQUFnRTtBQWFoRSxNQUFNLEVBQ0osWUFBWSxFQUNaLFNBQVMsRUFDVCxNQUFNLEVBQ04sU0FBUyxFQUNULFdBQVcsRUFDWCxTQUFTLEVBQ1QsUUFBUSxFQUNSLGtCQUFrQixFQUNuQixHQUFHLDJCQUFrQixDQUFDO0FBRXZCLDZCQUE2QjtBQUM3QiwyQkFBMkI7QUFDM0IsbUJBQVEsRUFBRSxDQUFDO0FBQ1gsZ0JBQU8sQ0FBQyxrQkFBa0IsQ0FBQztLQUMxQixJQUFJLENBQUMsQ0FBQyxVQUFVLEVBQUUsRUFBRTtJQUNuQixPQUFPLDhCQUFhLENBQUMsV0FBVyxFQUFFLGtCQUFrQixDQUFDLFFBQVEsRUFBRSxTQUFTLEVBQUUsUUFBUSxDQUFDLENBQUM7QUFDdEYsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRTtJQUNYLE1BQU0sTUFBTSxHQUEwQixPQUFPLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxjQUFjLENBQUM7SUFDbEYsTUFBTSxPQUFPLEdBQUcsTUFBTSxDQUFDLFlBQVksRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLFdBQVcsRUFBRSxTQUFTLENBQUMsQ0FBQztJQUVoRiwyQkFBVyxDQUFDLFdBQVcsQ0FBQyxFQUFDLEdBQUcsRUFBRSxtQkFBUSxFQUFFLEVBQUMsQ0FBQyxDQUFDO0lBQzNDLDJCQUFXLENBQUMsV0FBVyxDQUFDLEVBQUMsTUFBTSxFQUFFLE9BQU8sRUFBQyxDQUFDLENBQUM7QUFDN0MsQ0FBQyxDQUFDLENBQUMiLCJmaWxlIjoibm9kZV9tb2R1bGVzL0Bkci1jb3JlL25nLWFwcC1idWlsZGVyL2Rpc3QvbmcvY2hhbmdlLXRzY29uZmlnLXdvcmtlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7cGFyZW50UG9ydCwgd29ya2VyRGF0YX0gZnJvbSAnd29ya2VyX3RocmVhZHMnO1xuaW1wb3J0IHtjcmVhdGVUc0NvbmZpZywgUGFyaWFsQnJvd3Nlck9wdGlvbnN9IGZyb20gJy4vY2hhbmdlLXRzY29uZmlnJztcbmltcG9ydCB7aW5pdENsaSwgRHJjcEJ1aWxkZXJPcHRpb25zfSBmcm9tICcuL2NvbW1vbic7XG5pbXBvcnQge2luamVjdG9yU2V0dXB9IGZyb20gJy4vaW5qZWN0b3Itc2V0dXAnO1xuaW1wb3J0IHsgRHJjcFNldHRpbmcgfSBmcm9tICcuLi9jb25maWd1cmFibGUnO1xuaW1wb3J0IHtQYWNrYWdlSW5mb30gZnJvbSAnZHItY29tcC1wYWNrYWdlL3dmaC9kaXN0L2J1aWxkLXV0aWwvdHMvbWFpbic7XG5pbXBvcnQgbWVtc3RhdHMgZnJvbSAnZHItY29tcC1wYWNrYWdlL3dmaC9kaXN0L3V0aWxzL21lbS1zdGF0cyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRGF0YSB7XG4gIHRzY29uZmlnRmlsZTogc3RyaW5nO1xuICByZXBvcnREaXI6IHN0cmluZztcbiAgY29uZmlnOiBEcmNwU2V0dGluZztcbiAgbmdPcHRpb25zOiBQYXJpYWxCcm93c2VyT3B0aW9ucztcbiAgcGFja2FnZUluZm86IFBhY2thZ2VJbmZvO1xuICBkZXBsb3lVcmw6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgYmFzZUhyZWY/OiBzdHJpbmc7XG4gIGRyY3BCdWlsZGVyT3B0aW9uczogRHJjcEJ1aWxkZXJPcHRpb25zO1xufVxuXG5jb25zdCB7XG4gIHRzY29uZmlnRmlsZSxcbiAgcmVwb3J0RGlyLFxuICBjb25maWcsXG4gIG5nT3B0aW9ucyxcbiAgcGFja2FnZUluZm8sXG4gIGRlcGxveVVybCxcbiAgYmFzZUhyZWYsXG4gIGRyY3BCdWlsZGVyT3B0aW9uc1xufSA9IHdvcmtlckRhdGEgYXMgRGF0YTtcblxuLy8gdHNsaW50OmRpc2FibGU6IG5vLWNvbnNvbGVcbi8vIGNvbnNvbGUubG9nKHdvcmtlckRhdGEpO1xubWVtc3RhdHMoKTtcbmluaXRDbGkoZHJjcEJ1aWxkZXJPcHRpb25zKVxuLnRoZW4oKGRyY3BDb25maWcpID0+IHtcbiAgcmV0dXJuIGluamVjdG9yU2V0dXAocGFja2FnZUluZm8sIGRyY3BCdWlsZGVyT3B0aW9ucy5kcmNwQXJncywgZGVwbG95VXJsLCBiYXNlSHJlZik7XG59KS50aGVuKCgpID0+IHtcbiAgY29uc3QgY3JlYXRlOiB0eXBlb2YgY3JlYXRlVHNDb25maWcgPSByZXF1aXJlKCcuL2NoYW5nZS10c2NvbmZpZycpLmNyZWF0ZVRzQ29uZmlnO1xuICBjb25zdCBjb250ZW50ID0gY3JlYXRlKHRzY29uZmlnRmlsZSwgbmdPcHRpb25zLCBjb25maWcsIHBhY2thZ2VJbmZvLCByZXBvcnREaXIpO1xuXG4gIHBhcmVudFBvcnQhLnBvc3RNZXNzYWdlKHtsb2c6IG1lbXN0YXRzKCl9KTtcbiAgcGFyZW50UG9ydCEucG9zdE1lc3NhZ2Uoe3Jlc3VsdDogY29udGVudH0pO1xufSk7XG4iXX0=
