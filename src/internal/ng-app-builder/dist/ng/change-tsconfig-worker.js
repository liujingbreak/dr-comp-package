"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const worker_threads_1 = require("worker_threads");
const common_1 = require("./common");
const injector_setup_1 = require("./injector-setup");
const mem_stats_1 = __importDefault(require("@wfh/plink/wfh/dist/utils/mem-stats"));
const { tsconfigFile, reportDir, config, ngOptions, packageInfo, deployUrl, baseHref, drcpBuilderOptions } = worker_threads_1.workerData;
// tslint:disable: no-console
// console.log(workerData);
mem_stats_1.default();
common_1.initCli(drcpBuilderOptions)
    .then((drcpConfig) => {
    injector_setup_1.injectorSetup(packageInfo, drcpBuilderOptions.drcpArgs, deployUrl, baseHref);
    const create = require('./change-tsconfig').createTsConfig;
    const content = create(tsconfigFile, ngOptions, config, packageInfo, reportDir);
    worker_threads_1.parentPort.postMessage({ log: mem_stats_1.default() });
    worker_threads_1.parentPort.postMessage({ result: content });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hhbmdlLXRzY29uZmlnLXdvcmtlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImNoYW5nZS10c2NvbmZpZy13b3JrZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxtREFBc0Q7QUFFdEQscUNBQXFEO0FBQ3JELHFEQUErQztBQUcvQyxvRkFBMkQ7QUFhM0QsTUFBTSxFQUNKLFlBQVksRUFDWixTQUFTLEVBQ1QsTUFBTSxFQUNOLFNBQVMsRUFDVCxXQUFXLEVBQ1gsU0FBUyxFQUNULFFBQVEsRUFDUixrQkFBa0IsRUFDbkIsR0FBRywyQkFBa0IsQ0FBQztBQUV2Qiw2QkFBNkI7QUFDN0IsMkJBQTJCO0FBQzNCLG1CQUFRLEVBQUUsQ0FBQztBQUNYLGdCQUFPLENBQUMsa0JBQWtCLENBQUM7S0FDMUIsSUFBSSxDQUFDLENBQUMsVUFBVSxFQUFFLEVBQUU7SUFDbkIsOEJBQWEsQ0FBQyxXQUFXLEVBQUUsa0JBQWtCLENBQUMsUUFBUSxFQUFFLFNBQVMsRUFBRSxRQUFRLENBQUMsQ0FBQztJQUM3RSxNQUFNLE1BQU0sR0FBMEIsT0FBTyxDQUFDLG1CQUFtQixDQUFDLENBQUMsY0FBYyxDQUFDO0lBQ2xGLE1BQU0sT0FBTyxHQUFHLE1BQU0sQ0FBQyxZQUFZLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFBRSxXQUFXLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFFaEYsMkJBQVcsQ0FBQyxXQUFXLENBQUMsRUFBQyxHQUFHLEVBQUUsbUJBQVEsRUFBRSxFQUFDLENBQUMsQ0FBQztJQUMzQywyQkFBVyxDQUFDLFdBQVcsQ0FBQyxFQUFDLE1BQU0sRUFBRSxPQUFPLEVBQUMsQ0FBQyxDQUFDO0FBQzdDLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtwYXJlbnRQb3J0LCB3b3JrZXJEYXRhfSBmcm9tICd3b3JrZXJfdGhyZWFkcyc7XG5pbXBvcnQge2NyZWF0ZVRzQ29uZmlnLCBQYXJpYWxCcm93c2VyT3B0aW9uc30gZnJvbSAnLi9jaGFuZ2UtdHNjb25maWcnO1xuaW1wb3J0IHtpbml0Q2xpLCBEcmNwQnVpbGRlck9wdGlvbnN9IGZyb20gJy4vY29tbW9uJztcbmltcG9ydCB7aW5qZWN0b3JTZXR1cH0gZnJvbSAnLi9pbmplY3Rvci1zZXR1cCc7XG5pbXBvcnQgeyBEcmNwU2V0dGluZyB9IGZyb20gJy4uL2NvbmZpZ3VyYWJsZSc7XG5pbXBvcnQge1BhY2thZ2VJbmZvfSBmcm9tICdAd2ZoL3BsaW5rL3dmaC9kaXN0L3BhY2thZ2UtbWdyL3BhY2thZ2UtaW5mby1nYXRoZXJpbmcnO1xuaW1wb3J0IG1lbXN0YXRzIGZyb20gJ0B3ZmgvcGxpbmsvd2ZoL2Rpc3QvdXRpbHMvbWVtLXN0YXRzJztcblxuZXhwb3J0IGludGVyZmFjZSBEYXRhIHtcbiAgdHNjb25maWdGaWxlOiBzdHJpbmc7XG4gIHJlcG9ydERpcjogc3RyaW5nO1xuICBjb25maWc6IERyY3BTZXR0aW5nO1xuICBuZ09wdGlvbnM6IFBhcmlhbEJyb3dzZXJPcHRpb25zO1xuICBwYWNrYWdlSW5mbzogUGFja2FnZUluZm87XG4gIGRlcGxveVVybDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICBiYXNlSHJlZj86IHN0cmluZztcbiAgZHJjcEJ1aWxkZXJPcHRpb25zOiBEcmNwQnVpbGRlck9wdGlvbnM7XG59XG5cbmNvbnN0IHtcbiAgdHNjb25maWdGaWxlLFxuICByZXBvcnREaXIsXG4gIGNvbmZpZyxcbiAgbmdPcHRpb25zLFxuICBwYWNrYWdlSW5mbyxcbiAgZGVwbG95VXJsLFxuICBiYXNlSHJlZixcbiAgZHJjcEJ1aWxkZXJPcHRpb25zXG59ID0gd29ya2VyRGF0YSBhcyBEYXRhO1xuXG4vLyB0c2xpbnQ6ZGlzYWJsZTogbm8tY29uc29sZVxuLy8gY29uc29sZS5sb2cod29ya2VyRGF0YSk7XG5tZW1zdGF0cygpO1xuaW5pdENsaShkcmNwQnVpbGRlck9wdGlvbnMpXG4udGhlbigoZHJjcENvbmZpZykgPT4ge1xuICBpbmplY3RvclNldHVwKHBhY2thZ2VJbmZvLCBkcmNwQnVpbGRlck9wdGlvbnMuZHJjcEFyZ3MsIGRlcGxveVVybCwgYmFzZUhyZWYpO1xuICBjb25zdCBjcmVhdGU6IHR5cGVvZiBjcmVhdGVUc0NvbmZpZyA9IHJlcXVpcmUoJy4vY2hhbmdlLXRzY29uZmlnJykuY3JlYXRlVHNDb25maWc7XG4gIGNvbnN0IGNvbnRlbnQgPSBjcmVhdGUodHNjb25maWdGaWxlLCBuZ09wdGlvbnMsIGNvbmZpZywgcGFja2FnZUluZm8sIHJlcG9ydERpcik7XG5cbiAgcGFyZW50UG9ydCEucG9zdE1lc3NhZ2Uoe2xvZzogbWVtc3RhdHMoKX0pO1xuICBwYXJlbnRQb3J0IS5wb3N0TWVzc2FnZSh7cmVzdWx0OiBjb250ZW50fSk7XG59KTtcbiJdfQ==