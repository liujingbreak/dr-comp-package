"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const worker_threads_1 = require("worker_threads");
const common_1 = require("./common");
const injector_setup_1 = require("./injector-setup");
const mem_stats_1 = tslib_1.__importDefault(require("dr-comp-package/wfh/dist/utils/mem-stats"));
if (!worker_threads_1.isMainThread) {
    const { tsconfigFile, reportFile, config, ngOptions, packageInfo, deployUrl, baseHref, drcpBuilderOptions } = worker_threads_1.workerData;
    // console.log('hey');
    // console.log(workerData);
    common_1.initCli(drcpBuilderOptions)
        .then((drcpConfig) => {
        return injector_setup_1.injectorSetup(packageInfo, drcpBuilderOptions.drcpArgs, deployUrl, baseHref);
    }).then(() => {
        const create = require('./change-tsconfig').createTsConfig;
        const content = create(tsconfigFile, ngOptions, config, packageInfo, reportFile);
        worker_threads_1.parentPort.postMessage(content);
        mem_stats_1.default();
        process.exit(0);
    });
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9AZHItY29yZS9uZy1hcHAtYnVpbGRlci90cy9uZy9jaGFuZ2UtdHNjb25maWctd29ya2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLG1EQUFvRTtBQUVwRSxxQ0FBcUQ7QUFDckQscURBQStDO0FBRy9DLGlHQUFnRTtBQWFoRSxJQUFJLENBQUMsNkJBQVksRUFBRTtJQUNqQixNQUFNLEVBQ0osWUFBWSxFQUNaLFVBQVUsRUFDVixNQUFNLEVBQ04sU0FBUyxFQUNULFdBQVcsRUFDWCxTQUFTLEVBQ1QsUUFBUSxFQUNSLGtCQUFrQixFQUNuQixHQUFHLDJCQUFrQixDQUFDO0lBRXZCLHNCQUFzQjtJQUN0QiwyQkFBMkI7SUFFM0IsZ0JBQU8sQ0FBQyxrQkFBa0IsQ0FBQztTQUMxQixJQUFJLENBQUMsQ0FBQyxVQUFVLEVBQUUsRUFBRTtRQUNuQixPQUFPLDhCQUFhLENBQUMsV0FBVyxFQUFFLGtCQUFrQixDQUFDLFFBQVEsRUFBRSxTQUFTLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFDdEYsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRTtRQUNYLE1BQU0sTUFBTSxHQUEwQixPQUFPLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxjQUFjLENBQUM7UUFDbEYsTUFBTSxPQUFPLEdBQUcsTUFBTSxDQUFDLFlBQVksRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLFdBQVcsRUFBRSxVQUFVLENBQUMsQ0FBQztRQUVqRiwyQkFBVyxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNqQyxtQkFBUSxFQUFFLENBQUM7UUFDWCxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2xCLENBQUMsQ0FBQyxDQUFDO0NBRUoiLCJmaWxlIjoibm9kZV9tb2R1bGVzL0Bkci1jb3JlL25nLWFwcC1idWlsZGVyL2Rpc3QvbmcvY2hhbmdlLXRzY29uZmlnLXdvcmtlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7cGFyZW50UG9ydCwgd29ya2VyRGF0YSwgaXNNYWluVGhyZWFkfSBmcm9tICd3b3JrZXJfdGhyZWFkcyc7XG5pbXBvcnQge2NyZWF0ZVRzQ29uZmlnLCBQYXJpYWxCcm93c2VyT3B0aW9uc30gZnJvbSAnLi9jaGFuZ2UtdHNjb25maWcnO1xuaW1wb3J0IHtpbml0Q2xpLCBEcmNwQnVpbGRlck9wdGlvbnN9IGZyb20gJy4vY29tbW9uJztcbmltcG9ydCB7aW5qZWN0b3JTZXR1cH0gZnJvbSAnLi9pbmplY3Rvci1zZXR1cCc7XG5pbXBvcnQgeyBEcmNwU2V0dGluZyB9IGZyb20gJy4uL2NvbmZpZ3VyYWJsZSc7XG5pbXBvcnQge1BhY2thZ2VJbmZvfSBmcm9tICdkci1jb21wLXBhY2thZ2Uvd2ZoL2Rpc3QvYnVpbGQtdXRpbC90cy9tYWluJztcbmltcG9ydCBtZW1zdGF0cyBmcm9tICdkci1jb21wLXBhY2thZ2Uvd2ZoL2Rpc3QvdXRpbHMvbWVtLXN0YXRzJztcblxuZXhwb3J0IGludGVyZmFjZSBEYXRhIHtcbiAgdHNjb25maWdGaWxlOiBzdHJpbmc7XG4gIHJlcG9ydEZpbGU6IHN0cmluZztcbiAgY29uZmlnOiBEcmNwU2V0dGluZztcbiAgbmdPcHRpb25zOiBQYXJpYWxCcm93c2VyT3B0aW9ucztcbiAgcGFja2FnZUluZm86IFBhY2thZ2VJbmZvO1xuICBkZXBsb3lVcmw6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgYmFzZUhyZWY/OiBzdHJpbmc7XG4gIGRyY3BCdWlsZGVyT3B0aW9uczogRHJjcEJ1aWxkZXJPcHRpb25zO1xufVxuXG5pZiAoIWlzTWFpblRocmVhZCkge1xuICBjb25zdCB7XG4gICAgdHNjb25maWdGaWxlLFxuICAgIHJlcG9ydEZpbGUsXG4gICAgY29uZmlnLFxuICAgIG5nT3B0aW9ucyxcbiAgICBwYWNrYWdlSW5mbyxcbiAgICBkZXBsb3lVcmwsXG4gICAgYmFzZUhyZWYsXG4gICAgZHJjcEJ1aWxkZXJPcHRpb25zXG4gIH0gPSB3b3JrZXJEYXRhIGFzIERhdGE7XG5cbiAgLy8gY29uc29sZS5sb2coJ2hleScpO1xuICAvLyBjb25zb2xlLmxvZyh3b3JrZXJEYXRhKTtcblxuICBpbml0Q2xpKGRyY3BCdWlsZGVyT3B0aW9ucylcbiAgLnRoZW4oKGRyY3BDb25maWcpID0+IHtcbiAgICByZXR1cm4gaW5qZWN0b3JTZXR1cChwYWNrYWdlSW5mbywgZHJjcEJ1aWxkZXJPcHRpb25zLmRyY3BBcmdzLCBkZXBsb3lVcmwsIGJhc2VIcmVmKTtcbiAgfSkudGhlbigoKSA9PiB7XG4gICAgY29uc3QgY3JlYXRlOiB0eXBlb2YgY3JlYXRlVHNDb25maWcgPSByZXF1aXJlKCcuL2NoYW5nZS10c2NvbmZpZycpLmNyZWF0ZVRzQ29uZmlnO1xuICAgIGNvbnN0IGNvbnRlbnQgPSBjcmVhdGUodHNjb25maWdGaWxlLCBuZ09wdGlvbnMsIGNvbmZpZywgcGFja2FnZUluZm8sIHJlcG9ydEZpbGUpO1xuXG4gICAgcGFyZW50UG9ydCEucG9zdE1lc3NhZ2UoY29udGVudCk7XG4gICAgbWVtc3RhdHMoKTtcbiAgICBwcm9jZXNzLmV4aXQoMCk7XG4gIH0pO1xuXG59XG4iXX0=
