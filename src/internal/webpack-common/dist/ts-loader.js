"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const replace_and_inject_1 = __importDefault(require("./tsjs/replace-and-inject"));
const loader = function (source, sourceMap) {
    const file = this.resourcePath;
    const opts = this.query;
    // console.log(file);
    const cb = this.async();
    try {
        const replaced = replace_and_inject_1.default(file, source, opts.injector, opts.tsConfigFile, opts.compileExpContext ? opts.compileExpContext(file) : {});
        cb(null, replaced, sourceMap);
    }
    catch (e) {
        console.error('[webpack-common.ts-loader]processing: ' + file, e);
        return cb(e);
    }
};
exports.default = loader;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHMtbG9hZGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsidHMtbG9hZGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQ0EsbUZBQXlEO0FBU3pELE1BQU0sTUFBTSxHQUFxQixVQUFTLE1BQU0sRUFBRSxTQUFTO0lBQ3pELE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUM7SUFDL0IsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLEtBQWdCLENBQUM7SUFDbkMscUJBQXFCO0lBQ3JCLE1BQU0sRUFBRSxHQUFHLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUN4QixJQUFJO1FBQ0YsTUFBTSxRQUFRLEdBQUcsNEJBQWdCLENBQUMsSUFBSSxFQUFFLE1BQWdCLEVBQUUsSUFBSSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsWUFBWSxFQUN4RixJQUFJLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDOUQsRUFBRyxDQUFDLElBQUksRUFBRSxRQUFRLEVBQUUsU0FBUyxDQUFDLENBQUM7S0FDaEM7SUFBQyxPQUFPLENBQUMsRUFBRTtRQUNWLE9BQU8sQ0FBQyxLQUFLLENBQUMsd0NBQXdDLEdBQUcsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQ2xFLE9BQU8sRUFBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO0tBQ2Y7QUFDSCxDQUFDLENBQUM7QUFFRixrQkFBZSxNQUFNLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyB3cCBmcm9tICd3ZWJwYWNrJztcbmltcG9ydCByZXBsYWNlQW5kSW5qZWN0IGZyb20gJy4vdHNqcy9yZXBsYWNlLWFuZC1pbmplY3QnO1xuaW1wb3J0IFJKIGZyb20gJ3JlcXVpcmUtaW5qZWN0b3InO1xuXG5leHBvcnQgaW50ZXJmYWNlIE9wdGlvbnMge1xuICB0c0NvbmZpZ0ZpbGU6IHN0cmluZztcbiAgaW5qZWN0b3I6IFJKO1xuICBjb21waWxlRXhwQ29udGV4dD86IChzb3VyY2VGaWxlOiBzdHJpbmcpID0+IHtbdmFyTmFtZTogc3RyaW5nXTogYW55fTtcbn1cblxuY29uc3QgbG9hZGVyOiB3cC5sb2FkZXIuTG9hZGVyID0gZnVuY3Rpb24oc291cmNlLCBzb3VyY2VNYXApIHtcbiAgY29uc3QgZmlsZSA9IHRoaXMucmVzb3VyY2VQYXRoO1xuICBjb25zdCBvcHRzID0gdGhpcy5xdWVyeSBhcyBPcHRpb25zO1xuICAvLyBjb25zb2xlLmxvZyhmaWxlKTtcbiAgY29uc3QgY2IgPSB0aGlzLmFzeW5jKCk7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVwbGFjZWQgPSByZXBsYWNlQW5kSW5qZWN0KGZpbGUsIHNvdXJjZSBhcyBzdHJpbmcsIG9wdHMuaW5qZWN0b3IsIG9wdHMudHNDb25maWdGaWxlLFxuICAgICAgb3B0cy5jb21waWxlRXhwQ29udGV4dCA/IG9wdHMuY29tcGlsZUV4cENvbnRleHQoZmlsZSkgOiB7fSk7XG4gICAgY2IhKG51bGwsIHJlcGxhY2VkLCBzb3VyY2VNYXApO1xuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS5lcnJvcignW3dlYnBhY2stY29tbW9uLnRzLWxvYWRlcl1wcm9jZXNzaW5nOiAnICsgZmlsZSwgZSk7XG4gICAgcmV0dXJuIGNiIShlKTtcbiAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgbG9hZGVyO1xuIl19