"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const replace_and_inject_1 = __importDefault(require("./tsjs/replace-and-inject"));
const loader = function (source, sourceMap) {
    const file = this.resourcePath;
    const opts = this.query;
    // console.log(file);
    const cb = this.async();
    try {
        const replaced = replace_and_inject_1.default(file, source, opts.injector, opts.tsConfigFile, opts.compileExpContex ? opts.compileExpContex(file) : {});
        cb(null, replaced, sourceMap);
    }
    catch (e) {
        console.error('[webpack-common.ts-loader]processing: ' + file, e);
        return cb(e);
    }
};
exports.default = loader;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHMtbG9hZGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsidHMtbG9hZGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQ0EsbUZBQXlEO0FBU3pELE1BQU0sTUFBTSxHQUFxQixVQUFTLE1BQU0sRUFBRSxTQUFTO0lBQ3pELE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUM7SUFDL0IsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLEtBQWdCLENBQUM7SUFDbkMscUJBQXFCO0lBQ3JCLE1BQU0sRUFBRSxHQUFHLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUN4QixJQUFJO1FBQ0YsTUFBTSxRQUFRLEdBQUcsNEJBQWdCLENBQUMsSUFBSSxFQUFFLE1BQWdCLEVBQUUsSUFBSSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsWUFBWSxFQUN4RixJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDNUQsRUFBRyxDQUFDLElBQUksRUFBRSxRQUFRLEVBQUUsU0FBUyxDQUFDLENBQUM7S0FDaEM7SUFBQyxPQUFPLENBQUMsRUFBRTtRQUNWLE9BQU8sQ0FBQyxLQUFLLENBQUMsd0NBQXdDLEdBQUcsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQ2xFLE9BQU8sRUFBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO0tBQ2Y7QUFDSCxDQUFDLENBQUM7QUFFRixrQkFBZSxNQUFNLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyB3cCBmcm9tICd3ZWJwYWNrJztcbmltcG9ydCByZXBsYWNlQW5kSW5qZWN0IGZyb20gJy4vdHNqcy9yZXBsYWNlLWFuZC1pbmplY3QnO1xuaW1wb3J0IFJKIGZyb20gJ3JlcXVpcmUtaW5qZWN0b3InO1xuXG5leHBvcnQgaW50ZXJmYWNlIE9wdGlvbnMge1xuICB0c0NvbmZpZ0ZpbGU6IHN0cmluZztcbiAgaW5qZWN0b3I6IFJKO1xuICBjb21waWxlRXhwQ29udGV4PzogKHNvdXJjZUZpbGU6IHN0cmluZykgPT4ge1t2YXJOYW1lOiBzdHJpbmddOiBhbnl9O1xufVxuXG5jb25zdCBsb2FkZXI6IHdwLmxvYWRlci5Mb2FkZXIgPSBmdW5jdGlvbihzb3VyY2UsIHNvdXJjZU1hcCkge1xuICBjb25zdCBmaWxlID0gdGhpcy5yZXNvdXJjZVBhdGg7XG4gIGNvbnN0IG9wdHMgPSB0aGlzLnF1ZXJ5IGFzIE9wdGlvbnM7XG4gIC8vIGNvbnNvbGUubG9nKGZpbGUpO1xuICBjb25zdCBjYiA9IHRoaXMuYXN5bmMoKTtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXBsYWNlZCA9IHJlcGxhY2VBbmRJbmplY3QoZmlsZSwgc291cmNlIGFzIHN0cmluZywgb3B0cy5pbmplY3Rvciwgb3B0cy50c0NvbmZpZ0ZpbGUsXG4gICAgICBvcHRzLmNvbXBpbGVFeHBDb250ZXggPyBvcHRzLmNvbXBpbGVFeHBDb250ZXgoZmlsZSkgOiB7fSk7XG4gICAgY2IhKG51bGwsIHJlcGxhY2VkLCBzb3VyY2VNYXApO1xuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS5lcnJvcignW3dlYnBhY2stY29tbW9uLnRzLWxvYWRlcl1wcm9jZXNzaW5nOiAnICsgZmlsZSwgZSk7XG4gICAgcmV0dXJuIGNiIShlKTtcbiAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgbG9hZGVyO1xuIl19